
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>登陆/注册</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta content="telephone=no" name="format-detection" />
<link href="css/jquery.mobile-1.3.2.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link href="css/jquery.mobile.my.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link href="css/my.mobile-1.0.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link rel="stylesheet" href="css/bootstrap.min.css">
<script type="text/javascript" src="css/jquery-1.10.2.js"></script>
<script type="text/javascript" src="fivegold.js"></script>

<style>
.user-ui-header{
	font-size:20px;
	color:#ffffff;
	background:#b3a99f;
	line-height:50px;
	text-align: center;
}
.user-ui-header .left-bar{
	float:left;
	padding-left:10px;
	color:#ffffff;
}

.user-ui-header .right-bar{
	float:right;
	padding-right:10px;
	color:#ffffff;
}
.user-ui-content{
	padding:10px 10px;
}
.user-ui-footer {
	font-size: 20px;
	color: #ffffff;
	background: #b3a99f;
	line-height: 50px;
	text-align: center;
}
</style>
</head>
<body><!-- page -->
<div class="user-ui-page">
<!-- header -->
<div class="user-ui-header clearfix">
	<a class="left-bar" href="go.html">
		<span class="glyphicon glyphicon-home"></span>
	</a>
	<span >注册帐号</span>

</div>
<!-- /header -->

<script>

$(document).ready(function() {
	 document.getElementById('login_dialog').style.display ='none';
});

function adduser(){
	var uname=encodeURIComponent(document.getElementById('uname').value);
	var password=encodeURIComponent(document.getElementById('password').value);
	var password_again=encodeURIComponent(document.getElementById('password_again').value);
	var tel=encodeURIComponent(document.getElementById('tel').value);
	var email=encodeURIComponent(document.getElementById('email').value);
	var posturl ="http://www.zgltong.com/api/mobile.php?act=users&username="+uname+"&password="+password+"&tel="+tel+"&mode=test&email="+email;
	//alert(posturl);
	var xhr = new XMLHttpRequest();
	xhr.open("GET", posturl, true);
	xhr.onreadystatechange = function() {
  		 if (xhr.readyState==4 && xhr.status==200){
    		var resultfromphp = xhr.responseText;
			//alert (resultfromphp);
    		var objData = jQuery.parseJSON(resultfromphp);
			document.getElementById('alertmsg').innerHTML=objData.rsgmsg;
			document.getElementById('login_dialog').style.display ='block';
			if (objData.rsgcode=='000'){
         	     setTimeout("document.getElementById('login_dialog').style.display ='none'",1000);
				 document.location.href="login.html";
    		}
			else {
				setTimeout("document.getElementById('login_dialog').style.display ='none'",1000);
			}
		 }
	};
	xhr.send();
}

function myshow(msg){
	document.getElementById('alertmsg').innerHTML=msg;
	document.getElementById('login_dialog').style.display ='block';
	setTimeout("document.getElementById('login_dialog').style.display ='none'",1000)
}
</script>

<!-- content -->
<div class="user-ui-content">
		<form data-role="form"  id="register_form" action="javascript:adduser();" method="post">

		<section class="form-group">
			<label for="uname">用户名：</label>
			<input class="form-control" type="text" data-clear-btn="true" name="uname" id="uname" value="" placeholder="请输入用户名">
				<p class="alert alert-danger user-ui-warning-text"><a data-inline="true" data-icon="alert" data-role="button" data-iconpos="notext" data-theme="b"></a><span class="msg">请输入用户名</span></p>
		</section>
		<section class="form-group">
			<label for="password">密码：</label>
			<input class="form-control" type="password" data-clear-btn="true" name="password" id="password" value="" autocomplete="off" placeholder="请输入密码">
				<p class="alert alert-danger user-ui-warning-text"><a data-inline="true" data-icon="alert" data-role="button" data-iconpos="notext" data-theme="b"></a><span class="msg">请输入密码</span></p>
		</section>
		<section class="form-group">
			<label for="password_again">再次输入密码：</label>
			<input class="form-control" type="password" data-clear-btn="true" name="password_again" id="password_again" value="" autocomplete="off" placeholder="请再次输入密码">
				<p class="alert alert-danger user-ui-warning-text"><a data-inline="true" data-icon="alert" data-role="button" data-iconpos="notext" data-theme="b"></a><span class="msg">请再次输入密码</span></p>
		</section>
		<section class="form-group">
			<label for="tel">手机：</label>
			<input class="form-control" type="text" data-clear-btn="true" name="tel" id="tel" value="" placeholder="请输入手机" maxlength="11">
				<p class="alert alert-danger user-ui-warning-text"><a data-inline="true" data-icon="alert" data-role="button" data-iconpos="notext" data-theme="b"></a><span class="msg">请输入手机</span></p>
		</section>
		<section class="form-group">
			<label for="email">邮箱：</label>
			<input class="form-control" type="email" data-clear-btn="true" name="email" id="email" value="" placeholder="请输入邮箱">
				<p class="alert alert-danger user-ui-warning-text"><a data-inline="true" data-icon="alert" data-role="button" data-iconpos="notext" data-theme="b"></a><span class="msg">请输入邮箱</span></p>
		</section>

		<section class="form-group">
			<div class="checkbox">
				<label>
					<input type="checkbox" name="license" value="agree" checked="checked">
					<span>同意注册协议</span>
					<a href="marticle.html" target="_blank">《轮通惠用户协议》</a>
				</label>
			</div>
		</section>
		<section class="form-group">
			<input data-theme="f" type="button" id="register_submit" value="注册" class="btn btn-info btn-block">
            </section>
		<section>
			<p class="user-text-center">
				<span>已有帐号点击这里</span>
				<a href="login.html">登陆</a>
			</p>
		</section>
	</form>
</div>
<!-- /content -->
</div>


<script type="text/javascript">
	$('#register_submit').click(function(){
		if(!$('#uname').val()){
			myshow('请填写用户名');
			return;
		}
		if(!$('#password').val()){
			myshow('请填写密码');
			return;
		}
		if($('#password').val()!=$('#password_again').val()){
			myshow('两次输入的密码不一致');
			return;
		}
		if(!$('#tel').val()){
			myshow('请填写手机');
			return;
		}
		$('#register_form').submit();
	});
</script>

<div id="login_dialog" style="z-index:9999;position:fixed;left:100px;top:150px;width:150px;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">提示</h4>
      </div>
      <div class="modal-body" id="alertmsg"></div>
    </div>
  </div>
</div>
<script type="text/javascript">

		$('#uname').bind('blur',function(){
			if($(this).val()){
				$(this).next().hide();
			}else{
				$(this).next().show();
			}
		});
		$('#password').bind('blur',function(){
			if($(this).val()){
				$(this).next().hide();
			}else{
				$(this).next().show();
			}
		});
		$('#password_again').bind('blur',function(){
			if($(this).val()){
				// 验证再次输入的密码和第一次输入的密码是否一致
				if($('#password').val()!=$('#password_again').val()){
					$(this).next().find('.msg').text('2次输入的密码不一致');
					$(this).next().show();
				}else{
					$(this).next().hide();
				}
			}else{
				$(this).next().find('.msg').text('请再次输入密码');
				$(this).next().show();
			}
		});
		$('#tel').bind('blur',function(){
			if($(this).val()){
				$(this).next().hide();
			}else{
				$(this).next().show();
			}
		});
</script>
</body>
</html>